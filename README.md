# 农作物种植策略优化 (Crop Planting Strategy Optimization)

## 📖 项目简介

这是2024年高教社杯全国大学生数学建模竞赛C题的解决方案。项目针对华北山区某乡村的农作物种植策略进行优化建模，综合考虑地块约束、作物轮作、市场需求、价格波动等多种因素，提供科学的种植决策支持。

### 🎯 主要特色

- **多约束优化建模**：严格遵循种植规律和地块限制
- **动态风险考虑**：考虑价格、产量、成本的不确定性
- **作物相关性建模**：引入可替代性、互补性和需求弹性
- **完整验证体系**：全面的约束条件验证和结果分析
- **可视化结果**：详细的数据分析和策略建议

## 🚀 快速开始

### 环境要求

```bash
Python 3.8+
pandas >= 1.3.0
numpy >= 1.21.0
pulp >= 2.6.0
openpyxl >= 3.0.0
```

### 安装依赖

```bash
pip install -r requirements.txt
```

### 运行示例

```bash
# 数据预处理
python data_preprocessing.py

# 问题1：基础优化模型
python question1_modeling.py

# 问题2：考虑不确定性的模型
python question2_modeling.py

# 问题3：考虑相关性的高级模型
python question3_modeling.py
```

## 📁 项目结构

```
├── data/                   # 数据文件
│   ├── 附件1.xlsx         # 乡村现有耕地和农作物基本情况
│   ├── 附件2.xlsx         # 2023年农作物种植和统计数据
│   └── processed_data.xlsx # 预处理后的数据
├── src/                    # 源代码
│   ├── data_preprocessing.py    # 数据预处理模块
│   ├── question1_modeling.py   # 问题1建模求解
│   ├── question2_modeling.py   # 问题2建模求解
│   └── question3_modeling.py   # 问题3建模求解
├── results/                # 结果文件
│   ├── result1_1.xlsx            # 问题1场景1结果
│   ├── result1_2.xlsx            # 问题1场景2结果
│   ├── result2.xlsx              # 问题2结果
│   └── result3.xlsx              # 问题3结果
├── docs/                   # 文档
│   ├── problem_description.pdf   # 题目描述
│   ├── model_explanation.md      # 模型详细说明
│   └── results_analysis.md       # 结果分析报告
├── examples/               # 示例和教程
│   └── tutorial.ipynb     # Jupyter教程
├── tests/                  # 测试文件
│   └── test_models.py     # 模型测试
├── requirements.txt        # 依赖包列表
├── LICENSE                 # 开源协议
└── README.md              # 项目说明
```

## 🔧 核心功能

### 1. 数据预处理 (`data_preprocessing.py`)

- 自动读取和清洗Excel数据
- 处理地块信息、作物分类、统计数据
- 智慧大棚数据补全
- 生成统一的数据格式

### 2. 问题1：基础优化模型 (`question1_modeling.py`)

**特点：**
- 严格遵循种植规则约束
- 地块面积限制
- 重茬避免和豆类轮作
- 销售量约束

**两种场景：**
- 场景1：超产部分滞销浪费
- 场景2：超产部分降价50%销售

### 3. 问题2：不确定性建模 (`question2_modeling.py`)

**考虑因素：**
- 销售量变化：小麦玉米增长5%-10%，其他±5%
- 亩产量波动：±10%
- 成本增长：每年5%
- 价格变化：粮食稳定，蔬菜增长5%，食用菌下降1%-5%

### 4. 问题3：相关性建模 (`question3_modeling.py`)

**创新特性：**
- 作物可替代性矩阵
- 作物互补性建模
- 需求价格弹性
- 规模经济效应
- 风险调整机制
- 多样性激励

### 5. 约束验证 (`question1_validator.py`)

- 地块面积约束验证
- 种植规则合规性检查
- 销售量限制验证
- 重茬和轮作约束检查

## 📊 模型说明

### 数学建模方法

1. **线性规划**：基础优化框架
2. **整数规划**：水浇地选择决策
3. **多目标优化**：收益最大化与风险控制
4. **敏感性分析**：参数变化影响评估

### 约束条件体系

```
约束类型                     说明
├── 地块约束                 面积限制、地块类型匹配
├── 种植规则                 作物-地块-季次合法组合
├── 时间约束                 重茬避免、豆类轮作
├── 销售约束                 产量不超过需求量
├── 多样性约束               每年最少作物种类
└── 风险控制                 单一作物面积限制
```

## 📈 结果分析

### 关键指标

- **总利润**：7年期总经济效益
- **种植面积**：各类作物面积分布
- **作物多样性**：年度种植作物种类数
- **风险水平**：投资组合风险评估
- **约束符合率**：方案可行性验证

### 对比分析

| 模型版本 | 总利润 | 作物多样性 | 风险控制 | 创新点 |
|---------|--------|------------|----------|--------|
| 问题1 | 基准 | 中等 | 基础 | 严格约束遵循 |
| 问题2 | +15% | 提升 | 增强 | 不确定性建模 |
| 问题3 | +25% | 最优 | 全面 | 相关性建模 |

## 🛠️ 技术特点

### 优化算法
- **求解器**：PuLP + CBC
- **模型规模**：变量数>1000，约束数>500
- **求解效率**：<10分钟完成所有场景

### 数据处理
- **自动化**：一键运行完整流程
- **容错性**：智能处理数据缺失
- **可扩展**：支持新增地块和作物

### 结果输出
- **Excel报告**：详细的分析表格
- **约束验证**：完整的合规性检查
- **策略建议**：实用的决策支持

## 🤝 贡献指南

欢迎贡献代码、报告问题或提出建议！

### 开发环境设置

1. Fork本仓库
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送分支 (`git push origin feature/AmazingFeature`)
5. 打开Pull Request

### 代码规范

- 遵循PEP 8代码风格
- 添加必要的注释和文档字符串
- 包含单元测试
- 更新相关文档

## 📝 许可证

本项目采用MIT许可证 - 查看 [LICENSE](LICENSE) 文件了解详情

## 🙏 致谢

- 感谢2024年高教社杯全国大学生数学建模竞赛提供的优秀题目
- 感谢PuLP开发团队提供的优秀优化求解库
- 感谢所有为开源社区贡献的开发者

## 🔗 相关链接

- [数学建模竞赛官网](http://www.mcm.edu.cn/)
- [PuLP文档](https://coin-or.github.io/pulp/)
- [线性规划教程](https://en.wikipedia.org/wiki/Linear_programming)

---

⭐ 如果这个项目对你有帮助，请给我们一个Star！